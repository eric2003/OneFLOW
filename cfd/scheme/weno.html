

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WENO schemes &mdash; Scientific Computing 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="HLLC Riemann Solver" href="hllc.html" />
    <link rel="prev" title="Implicit Compact Pade (ICP) Scheme" href="icp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Scientific Computing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../info.html">OneFLOW</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user.html">THEORY</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../bash.html">Bash</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">CFD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ns.html">Navier–Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leibniz.html">Leibniz integral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rtt.html">Reynolds’ transport theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mass.html">Conservation Of Mass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../momenum.html">Momentum Analysis Of Flow Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../energy.html">Conservation Of Energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ns-integral.html">ALE Form of Conservation Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../curvilinear.html">Generalized Curvilinear Coordinate System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../curvilinear3d.html">Generalized Curvilinear Coordinate System(3D)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vector.html">Vector &amp; Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../calculus.html">Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../substitution.html">Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jacobian.html">Jacobian matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gauss.html">Gauss’s Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../strain.html">Strain Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ale.html">Arbitrary Lagrangian-Eulerian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ale1d.html">ALE 1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deformation.html">Deformation and Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../derivative.html">Fluid Derivative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../material_derivative.html">Material Time Derivative</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">CFD Schemes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="icp.html">Implicit Compact Pade (ICP) Scheme</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">WENO schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inviscid-burgers-equation-non-conservative-form">Inviscid Burgers Equation: Non-Conservative Form</a></li>
<li class="toctree-l4"><a class="reference internal" href="#weno-5-scheme">WENO-5 Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fifth-order-compact-reconstruction-weno-crweno">Fifth-order Compact Reconstruction WENO (CRWENO)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compact-reconstruction-weno-5-scheme">Compact Reconstruction WENO-5 Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#crweno-5-with-periodic-boundary-condition">CRWENO-5 with periodic boundary condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sherman-morrison-formula">Sherman-Morrison Formula</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hllc.html">HLLC Riemann Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="rusanov.html">Rusanov Riemann Solver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html">CFD Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../method/index.html">CFD Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codes.html">Reference Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../videos.html">CFD &amp; CAE Videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../books.html">Books</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs.html">Documents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cgns.html">CGNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chatgpt.html">CHATGPT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/index.html">CPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cmake.html">CMake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cmd.html">Cmd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda.html">CUDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_patterns.html">Design Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../eigen.html">Eigen3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git.html#contexts">Contexts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fortran.html">Fortran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hdf5.html">HDF5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc.html">HPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../julia.html">Julia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jupyter.html">Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../latex.html">LaTeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../makefile.html">Makefile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metis.html">METIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mkdocs.html">MkDocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Environment Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mpi.html">MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numerical/index.html">Numerical analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../oneapi.html">oneAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../oneflow.html">OneFLOW-CFD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openacc.html">OpenACC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opencl.html">OpenCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opengl.html">OpenGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openmp.html">OpenMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../powershell.html">PowerShell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qt.html">Qt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../regex.html">Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../science.html">Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system/index.html">System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../taichi.html">Taichi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tcltk.html">Tcl/tk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tecplot.html">Tecplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test.html">Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unreal_engine.html">Unreal Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vcpkg.html">vcpkg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../yaml.html">yaml</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scientific Computing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">CFD</a></li>
          <li class="breadcrumb-item"><a href="index.html">CFD Schemes</a></li>
      <li class="breadcrumb-item active">WENO schemes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/cfd/scheme/weno.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="weno-schemes">
<h1>WENO schemes<a class="headerlink" href="#weno-schemes" title="Link to this heading"></a></h1>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.mdpi.com/2311-5521/4/3/159/">CFD Julia: A Learning Module Structuring an Introductory Course on Computational Fluid Dynamics</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=ytl2Y9WfHmw/">Weighted Essentially Non-Oscillatory ( WENO ) - CFD</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=KT4l3lSSpDY/">Chi Wang Shu: High order schemes for convection dominated problems. Lecture 1. September, 19, 2013 - CFD</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=U8OCmPEvHfc/">SU2 Conference 21: Implementation of Higher Order WENO Schemes into SU2, Y. Chandukrishna</a></p></li>
<li><p><a class="reference external" href="http://debog.github.io/CRWENO/Overview.html">Compact-Reconstruction Weighted Essentially Non-Oscillatory (CRWENO) Schemes</a></p></li>
</ol>
<section id="inviscid-burgers-equation-non-conservative-form">
<h2>Inviscid Burgers Equation: Non-Conservative Form<a class="headerlink" href="#inviscid-burgers-equation-non-conservative-form" title="Link to this heading"></a></h2>
<p>In this section, we discuss the solution of the inviscid Burgers equation which is a nonlinear hyperbolic partial differential equation.
The hyperbolic equations admit discontinuities, and the numerical schemes used for solving hyperbolic PDEs need to be higher-order accurate for smooth solutions, and non-oscillatory for discontinuous solutions.
The inviscid Burgers equation is given below</p>
<div class="math notranslate nohighlight">
\[\cfrac{\partial u}{\partial t}+u\cfrac{\partial u}{\partial x}=0\]</div>
</section>
<section id="weno-5-scheme">
<h2>WENO-5 Scheme<a class="headerlink" href="#weno-5-scheme" title="Link to this heading"></a></h2>
<p>We refer readers to a text by Shu for a comprehensive overview of the development of WENO schemes,
their mathematical formulation, and the application of WENO schemes for convection dominated problems.
We will use WENO-5 scheme for one-dimensional inviscid Burgers equation with the shock developed by a sine wave.
We will discuss how one can go about applying WENO reconstruction for finite difference schemes.
The finite difference approximation to the inviscid Burgers equation in non-conserved form can be written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{\begin{matrix}
\cfrac{\partial u_{i}}{\partial t}+u_{i}\cfrac{u^{L}_{i+1/2}-u^{L}_{i-1/2}}{\Delta x}=0,&amp; if \quad u_{i}&gt;0\\
\cfrac{\partial u_{i}}{\partial t}+u_{i}\cfrac{u^{R}_{i+1/2}-u^{R}_{i-1/2}}{\Delta x}=0,&amp; \text{otherwise}\\
\end{matrix}\right.\end{split}\]</div>
<p>which can be combined into a more compact upwind/downwind notation as follows</p>
<div class="math notranslate nohighlight">
\[\cfrac{\partial u_{i}}{\partial t}
+u^{+}_{i}\cfrac{u^{L}_{i+1/2}-u^{L}_{i-1/2}}{\Delta x}
+u^{-}_{i}\cfrac{u^{R}_{i+1/2}-u^{R}_{i-1/2}}{\Delta x}
=0\]</div>
<p>where we define <span class="math notranslate nohighlight">\(u^{+}_{i}=max(u_{i},0)\)</span> and <span class="math notranslate nohighlight">\(u^{-}_{i}=min(u_{i},0)\)</span>. the reconstruction of <span class="math notranslate nohighlight">\(u^{L}_{i+1/2}\)</span> uses a biased stencil with one more point to the left,
and that for <span class="math notranslate nohighlight">\(u^{R}_{i+1/2}\)</span> uses a biased stencil with one more point to the right. The stencil used for reconstruction of left and right side state
(i.e., <span class="math notranslate nohighlight">\(u^{L}_{i+1/2}\)</span> and <span class="math notranslate nohighlight">\(u^{R}_{i+1/2}\)</span>) is shown in the following figure. The WENO-5 reconstruction for left and right side reconstructed values is given as</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/weno1.png"><img alt="../../_images/weno1.png" src="../../_images/weno1.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-text">Finite difference grid for one-dimensional problems where the the solution is stored at the interface of the cells. The first and last points lie on the left and right boundary of the domain. The stencil required for reconstruction of left and right side state is highlighted with blue rectangle. Ghost points are shown by red color.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u^{L}_{i+1/2} &amp; = w^{L}_{0}(\cfrac{1}{3}u_{i-2}-\cfrac{7}{6}u_{i-1}+\cfrac{11}{6}u_{i})\\
           &amp;+w^{L}_{1}(-\cfrac{1}{6}u_{i-1}+\cfrac{5}{6}u_{i}+\cfrac{1}{3}u_{i+1})\\
           &amp;+w^{L}_{2}(\cfrac{1}{3}u_{i}+\cfrac{5}{6}u_{i+1}-\cfrac{1}{6}u_{i+2})\\
u^{R}_{i-1/2}&amp; = w^{R}_{0}(-\cfrac{1}{6}u_{i-2}+\cfrac{5}{6}u_{i-1}+\cfrac{1}{3}u_{i})\\
           &amp; + w^{R}_{1}(\cfrac{1}{3}u_{i-1}+\cfrac{5}{6}u_{i}-\cfrac{1}{6}u_{i+1})\\
           &amp; + w^{R}_{2}(\cfrac{11}{6}u_{i}-\cfrac{7}{6}u_{i+1}+\cfrac{1}{3}u_{i+2})
\end{align}\end{split}\]</div>
<p>This formula can also be written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u^{L}_{i+1/2} &amp; = w^{L}_{0}q^{L}_{0}+w^{L}_{1}q^{L}_{1}+w^{L}_{2}q^{L}_{2}\\
u^{R}_{i-1/2} &amp; = w^{R}_{0}q^{R}_{0}+w^{R}_{1}q^{R}_{1}+w^{L}_{2}q^{R}_{2}\\
\end{align}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}q^{L}_{i+1/2}=\begin{bmatrix}
 q^{L}_{0}(i-2,i-1,i)\\q^{L}_{1}(i-1,i,i+1)\\q^{L}_{2}(i,i+1,i+2)
\end{bmatrix}
=\begin{bmatrix}
 \cfrac{1}{3}u_{i-2}-\cfrac{7}{6}u_{i-1}+\cfrac{11}{6}u_{i}\\
 -\cfrac{1}{6}u_{i-1}+\cfrac{5}{6}u_{i}+\cfrac{1}{3}u_{i+1}\\
\cfrac{1}{3}u_{i}+\cfrac{5}{6}u_{i+1}-\cfrac{1}{6}u_{i+2}
\end{bmatrix}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}q^{R}_{i-1/2}=\begin{bmatrix}
 q^{R}_{0}(i-2,i-1,i)\\q^{R}_{1}(i-1,i,i+1)\\q^{R}_{2}(i,i+1,i+2)
\end{bmatrix}
=\begin{bmatrix}
 -\cfrac{1}{6}u_{i-2}+\cfrac{5}{6}u_{i-1}+\cfrac{1}{3}u_{i}\\
  \cfrac{1}{3}u_{i-1}+\cfrac{5}{6}u_{i}-\cfrac{1}{6}u_{i+1}\\
  \cfrac{11}{6}u_{i}-\cfrac{7}{6}u_{i+1}+\cfrac{1}{3}u_{i+2}
\end{bmatrix}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}q^{R}_{i+1/2}=\begin{bmatrix}
 q^{R}_{0}(i-1,i,i+1)\\q^{R}_{1}(i,i+1,i+2)\\q^{R}_{2}(i+1,i+2,i+3)
\end{bmatrix}
=\begin{bmatrix}
 -\cfrac{1}{6}u_{i-1}+\cfrac{5}{6}u_{i}+\cfrac{1}{3}u_{i+1}\\
  \cfrac{1}{3}u_{i}+\cfrac{5}{6}u_{i+1}-\cfrac{1}{6}u_{i+2}\\
  \cfrac{11}{6}u_{i+1}-\cfrac{7}{6}u_{i+2}+\cfrac{1}{3}u_{i+3}
\end{bmatrix}\end{split}\]</div>
<p>where the nonlinear weights are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}
w^{L}_{k}=\cfrac{\alpha_{k}}{\alpha_{0}+\alpha_{1}+\alpha_{2}},\quad \alpha_{k}=\cfrac{d^{L}_{k}}{(\beta_{k}+\epsilon)^{2}},\quad k=0,1,2\\
w^{R}_{k}=\cfrac{\alpha_{k}}{\alpha_{0}+\alpha_{1}+\alpha_{2}},\quad \alpha_{k}=\cfrac{d^{R}_{k}}{(\beta_{k}+\epsilon)^{2}},\quad k=0,1,2
\end{array}\end{split}\]</div>
<p>in which the smoothness indicators are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\beta_{0}=\cfrac{13}{12}(u_{i-2}-2u_{i-1}+u_{i})^2+\cfrac{1}{4}(u_{i-2}-4u_{i-1}+3u_{i})^2\\
\beta_{1}=\cfrac{13}{12}(u_{i-1}-2u_{i}+u_{i+1})^2+\cfrac{1}{4}(u_{i-1}-u_{i+1})^2\\
\beta_{2}=\cfrac{13}{12}(u_{i}-2u_{i+1}+u_{i+2})^2+\cfrac{1}{4}(3u_{i}-4u_{i+1}+u_{i+2})^2
\end{array}\end{split}\]</div>
<p>We use <span class="math notranslate nohighlight">\(d^{L}_{0}=1/10,\quad d^{L}_{1}=3/5,\quad d^{L}_{2}=3/10\)</span> to compute nonlinear weights for calculation of left side state
and <span class="math notranslate nohighlight">\(d^{R}_{0}=3/10,\quad d^{R}_{1}=3/5,\quad d^{R}_{2}=1/10\)</span> to compute nonlinear weights for calculation of right side state.
We set <span class="math notranslate nohighlight">\(\epsilon =1\times10^{-6}\)</span> to avoid division by zero.</p>
<div class="math notranslate nohighlight">
\[\begin{split}d^{L}=\begin{bmatrix}
 d^{L}_{0}\\d^{L}_{1}\\d^{L}_{2}
\end{bmatrix}
=\begin{bmatrix}
 1/10\\3/5\\3/10
\end{bmatrix}
=\begin{bmatrix}
 0.1\\0.6\\0.3
\end{bmatrix}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}d^{R}=\begin{bmatrix}
 d^{R}_{0}\\d^{R}_{1}\\d^{R}_{2}
\end{bmatrix}
=\begin{bmatrix}
 3/10\\3/5\\1/10
\end{bmatrix}
=\begin{bmatrix}
 0.3\\0.6\\0.1
\end{bmatrix}\end{split}\]</div>
<p>We demonstrate two types of boundary conditions for the inviscid Burgers equation. The first one is the Dirichlet boundary condition. For Dirichlet boundary condition, we use
<span class="math notranslate nohighlight">\(u(x=0)=0\)</span> and <span class="math notranslate nohighlight">\(u(x=1)=0\)</span>. For computing numerical state at the interface, we need the information of five neighboring grid points.
When we compute the left side state at <span class="math notranslate nohighlight">\(i+1/2\)</span> interface, we use three points on left side (i.e., <span class="math notranslate nohighlight">\(u_{i-2},u_{i-1},u_{i}\)</span> )
and two points on right side (i.e., <span class="math notranslate nohighlight">\(u_{i+1},u_{i+2}\)</span>). Therefore, we use two ghost points on the left side of the domain and one ghost point on right side of the domain for computing left side state
(i.e., <span class="math notranslate nohighlight">\(u^{L}\)</span> at <span class="math notranslate nohighlight">\(x=3/2\)</span> and <span class="math notranslate nohighlight">\(x=N-1/2\)</span> respectively). Similarly, we use one ghost points on the left side of the domain and two ghost point on right side of the domain for computing right side state
(i.e., <span class="math notranslate nohighlight">\(u^{R}\)</span> at <span class="math notranslate nohighlight">\(x=3/2\)</span> and <span class="math notranslate nohighlight">\(x=N-1/2\)</span> respectively).
We use linear interpolation to compute the value of discrete field u at ghost points. The computation of <span class="math notranslate nohighlight">\(u\)</span> at ghost points is given below</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_{-2} &amp; = 3u_{1}-2u_{2}\\u_{-1} &amp; = 2u_{1}-u_{2}\\
u_{N+3} &amp; = 3u_{N+1}-2u_{N}\\u_{N+2} &amp; = 2u_{N+1}-u_{N}\\
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is stored from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(N+1\)</span> from left <span class="math notranslate nohighlight">\((x=0)\)</span> to right boundary <span class="math notranslate nohighlight">\((x=L)\)</span> on the computational domain respectively.</p>
<p>We also use the periodic boundary condition for the same problem. For periodic boundary condition, we do not need to use any interpolation formula to compute the variable at ghost points. The periodic boundary condition for two left and right side points outside the domain is given below</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_{-2} &amp; = u_{N-1}\\
u_{-1} &amp; = u_{N}\\
u_{N+2} &amp; = u_{2}\\
u_{N+3} &amp; = u_{3}\\
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is stored from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(N+1\)</span> from left <span class="math notranslate nohighlight">\((x=0)\)</span> to right boundary <span class="math notranslate nohighlight">\((x=L)\)</span> on the computational domain respectively.</p>
<p>detail:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
u^{L}_{i-1/2}=List(i-3,i-2,i-1,i,i+1)\\
u^{L}_{i+1/2}=List(i-2,i-1,i,i+1,i+2)\\
u^{R}_{i-1/2}=List(i-2,i-1,i,i+1,i+2)\\
u^{R}_{i+1/2}=List(i-1,i,i+1,i+2,i+3)\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\cfrac{\partial u_{i}}{\partial t}
+u^{+}_{i}\cfrac{u^{L}_{i+1/2}-u^{L}_{i-1/2}}{\Delta x}
+u^{-}_{i}\cfrac{u^{R}_{i+1/2}-u^{R}_{i-1/2}}{\Delta x}
=0\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\underbrace{\quad-1, \quad 0\quad}_{\text{ghost points}}
\underbrace{\quad\quad1\quad\quad}_{\text{boundary points}}
\underbrace{\quad2,3,\cdots,N-1,N\quad}_{\text{inner points}}
\underbrace{\quad N+1\quad}_{\text{boundary points}}
\underbrace{\quad N+2, \quad N+3}_{\text{ghost points}}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\cfrac{\partial u_{2}}{\partial t}
+u^{+}_{2}\cfrac{u^{L}_{2+1/2}-u^{L}_{2-1/2}}{\Delta x}
+u^{-}_{2}\cfrac{u^{R}_{2+1/2}-u^{R}_{2-1/2}}{\Delta x}
=0\\
\cfrac{\partial u_{3}}{\partial t}
+u^{+}_{3}\cfrac{u^{L}_{3+1/2}-u^{L}_{3-1/2}}{\Delta x}
+u^{-}_{3}\cfrac{u^{R}_{3+1/2}-u^{R}_{3-1/2}}{\Delta x}
=0\\
\cdots\\
\cfrac{\partial u_{N-1}}{\partial t}
+u^{+}_{N-1}\cfrac{u^{L}_{N-1+1/2}-u^{L}_{N-1-1/2}}{\Delta x}
+u^{-}_{N-1}\cfrac{u^{R}_{N-1+1/2}-u^{R}_{N-1-1/2}}{\Delta x}
=0\\
\cdots\\
\cfrac{\partial u_{N}}{\partial t}
+u^{+}_{N}\cfrac{u^{L}_{N+1/2}-u^{L}_{N-1/2}}{\Delta x}
+u^{-}_{N}\cfrac{u^{R}_{N+1/2}-u^{R}_{N-1/2}}{\Delta x}
=0\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}u^{L}=\left[\begin{array}{l}
 1=\text{ boundary point}\\
 u^{L}_{1+1/2=3/2}= List(-1,0,1,2,3)=\hat{u}^{L}(1)\\
 2=\text{ inner point}\\
 u^{L}_{2+1/2=5/2}= List(0,1,2,3,4)=\hat{u}^{L}(2)\\
 3=\text{ inner point}\\
 u^{L}_{3+1/2=7/2}= List(1,2,3,4,5)=\hat{u}^{L}(3)\\
 \vdots\\
 N-1=\text{ inner point}\\
 u^{L}_{N-1/2}= List(N-3,N-2,N-1,N,N+1)=\hat{u}^{L}(N-1)\\
 N=\text{ inner point}\\
 u^{L}_{N+1/2}= List(N-2,N-1,N,N+1,N+2)=\hat{u}^{L}(N)\\
 N+1=\text{ boundary point}\\
\end{array}\right]\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}u^{R}=\left[\begin{array}{l}
1=\text{ boundary point}\\
u^{R}_{1+1/2=3/2}= List(0,1,2,3,4)=\hat{u}^{R}(1)\\
2=\text{ inner point}\\
u^{R}_{2+1/2=5/2}= List(1,2,3,4,5)=\hat{u}^{R}(2)\\
3=\text{ inner point}\\
u^{R}_{3+1/2=7/2}= List(2,3,4,5,6)=\hat{u}^{R}(3)\\
\vdots\\
N-1=\text{ inner point}\\
u^{R}_{N-1/2}= List(N-2,N-1,N,N+1,N+2)=\hat{u}^{R}(N-1)\\
N=\text{ inner point}\\
u^{R}_{N+1/2}= List(N-1,N,N+1,N+2,N+3)=\hat{u}^{R}(N)\\
N+1=\text{ boundary point}\\
\end{array}\right]\end{split}\]</div>
<p>We also use the periodic boundary condition for the same problem. For periodic boundary condition, we do not need to use any interpolation formula to compute the variable at ghost points. The periodic boundary condition for two left and right side points outside the domain is given below</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_{-1} &amp; = u_{N-1}\\
u_{0} &amp; = u_{N}\\
u_{N+2} &amp; = u_{2}\\
u_{N+3} &amp; = u_{3}\\
\end{align}\end{split}\]</div>
<p>C or python array index starts from zero:</p>
<div class="math notranslate nohighlight">
\[\underbrace{\quad-2, \quad -1\quad}_{\text{ghost points}}
\underbrace{\quad\quad0\quad\quad}_{\text{boundary points}}
\underbrace{\quad1,2,\cdots,N-2,N-1\quad}_{\text{inner points}}
\underbrace{\quad N\quad}_{\text{boundary points}}
\underbrace{\quad N+1, \quad N+2}_{\text{ghost points}}\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_{-2} &amp; = u_{N-2}\\
u_{-1} &amp; = u_{N-1}\\
u_{N+1} &amp; = u_{1}\\
u_{N+2} &amp; = u_{2}\\
\end{align}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\cfrac{\partial u_{1}}{\partial t}
+u^{+}_{1}\cfrac{u^{L}_{1+1/2}-u^{L}_{1-1/2}}{\Delta x}
+u^{-}_{1}\cfrac{u^{R}_{1+1/2}-u^{R}_{1-1/2}}{\Delta x}
=0\\
\cfrac{\partial u_{2}}{\partial t}
+u^{+}_{2}\cfrac{u^{L}_{2+1/2}-u^{L}_{2-1/2}}{\Delta x}
+u^{-}_{2}\cfrac{u^{R}_{2+1/2}-u^{R}_{2-1/2}}{\Delta x}
=0\\
\cdots\\
\cfrac{\partial u_{N-2}}{\partial t}
+u^{+}_{N-2}\cfrac{u^{L}_{N-2+1/2}-u^{L}_{N-2-1/2}}{\Delta x}
+u^{-}_{N-2}\cfrac{u^{R}_{N-2+1/2}-u^{R}_{N-2-1/2}}{\Delta x}
=0\\
\cdots\\
\cfrac{\partial u_{N-1}}{\partial t}
+u^{+}_{N-1}\cfrac{u^{L}_{N-1+1/2}-u^{L}_{N-1-1/2}}{\Delta x}
+u^{-}_{N-1}\cfrac{u^{R}_{N-1+1/2}-u^{R}_{N-1-1/2}}{\Delta x}
=0\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}u^{L}=\left[\begin{array}{l}
 0=\text{ boundary point}\\
 u^{L}_{0+1/2=1/2}= List(-2,-1,0,1,2)=\hat{u}^{L}(0)\\
 1=\text{ inner point}\\
 u^{L}_{1+1/2=3/2}= List(-1,0,1,2,3)=\hat{u}^{L}(1)\\
 2=\text{ inner point}\\
 u^{L}_{2+1/2=5/2}= List(0,1,2,3,4)=\hat{u}^{L}(2)\\
 \vdots\\
 N-2=\text{ inner point}\\
 u^{L}_{N-2+1/2}= List(N-4,N-3,N-2,N-1,N)=\hat{u}^{L}(N-2)\\
 N-1=\text{ inner point}\\
 u^{L}_{N-1+1/2}= List(N-3,N-2,N-1,N,N+1)=\hat{u}^{L}(N-1)\\
 N=\text{ boundary point}\\
\end{array}\right]\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}u^{R}=\left[\begin{array}{l}
0=\text{ boundary point}\\
u^{R}_{0+1/2=1/2}= List(-1,0,1,2,3)=\hat{u}^{R}(0)\\
1=\text{ inner point}\\
u^{R}_{1+1/2=3/2}= List(0,1,2,3,4)=\hat{u}^{R}(1)\\
2=\text{ inner point}\\
u^{R}_{2+1/2=5/2}= List(1,2,3,4,5)=\hat{u}^{R}(2)\\
\vdots\\
N-2=\text{ inner point}\\
u^{R}_{N-2+1/2}= List(N-3,N-2,N-1,N,N+1)=\hat{u}^{R}(N-2)\\
N-1=\text{ inner point}\\
u^{R}_{N-1+1/2}= List(N-2,N-1,N,N+1,N+2)=\hat{u}^{R}(N-1)\\
N=\text{ boundary point}\\
\end{array}\right]\end{split}\]</div>
<p>For periodic boundary condition,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\cfrac{\partial u_{0}}{\partial t}
+u^{+}_{0}\cfrac{u^{L}_{1/2}-u^{L}_{-1/2}}{\Delta x}
+u^{-}_{0}\cfrac{u^{R}_{1/2}-u^{R}_{-1/2}}{\Delta x}
=0\\\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\underbrace{\overset{\otimes}{-2}, \overset{\otimes}{-1}}_{\text{ghost points}}
\underbrace{\overset{|}{-1/2}}_{\text{face}}
\underbrace{\overset{\otimes}{0}}_{\text{bc}}
\underbrace{\overset{|}{1/2}}_{\text{face}}
\underbrace{,\overset{\otimes}{1},\overset{\otimes}{2},\cdots,\overset{\otimes}{N-2},\overset{\otimes}{N-1},}_{\text{inner points}}
\underbrace{\overset{|}{N-1/2}}_{\text{face}}
\underbrace{\overset{\otimes}{N}}_{\text{bc}}
\underbrace{\overset{|}{N+1/2}}_{\text{face}}
\underbrace{,\overset{\otimes}{N+1},\overset{\otimes}{N+2}}_{\text{ghost points}}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
u^{L}_{-1/2}=u^{L}_{N-1/2}\Leftrightarrow \hat{u}^{L}_{-1}=\hat{u}^{L}_{N-1}\\
u^{R}_{-1/2}=u^{R}_{N-1/2}\Leftrightarrow \hat{u}^{R}_{-1}=\hat{u}^{R}_{N-1}\\
u^{L}_{N+1/2}=u^{L}_{1/2}\Leftrightarrow \hat{u}^{L}_{N}=\hat{u}^{L}_{1}\\
u^{R}_{N+1/2}=u^{R}_{1/2}\Leftrightarrow \hat{u}^{R}_{N}=\hat{u}^{R}_{1}\\
\end{array}\end{split}\]</div>
</section>
<section id="fifth-order-compact-reconstruction-weno-crweno">
<h2>Fifth-order Compact Reconstruction WENO (CRWENO)<a class="headerlink" href="#fifth-order-compact-reconstruction-weno-crweno" title="Link to this heading"></a></h2>
<p>High-order WENO schemes have wider stencils as the order increases. The fifthorder Compact Reconstruction WENO (CRWENO) [Ghosh &amp; Baeder, 2012] uses implicit interpolation to obtain higher resolution than its explicit counterpart while having
smaller candidate stencils, although since the smoothness indicators are the same, in
practice the overall stencil ends up being the same as the fifth-order WENO scheme.</p>
<p>The same procedure explained for the WENO5 applies to this scheme. There exist
optimal weights <span class="math notranslate nohighlight">\(\left\{ c_{k}\right\}^{r}_{k=1}\)</span> such that if <span class="math notranslate nohighlight">\(\omega_{k}=c_{k}\ \forall k\)</span>, a <span class="math notranslate nohighlight">\((2r − 1)-\text{th}\)</span> accurate interpolation
is obtained. For the CRWENO5 the coefficients are:</p>
<div class="math notranslate nohighlight">
\[c_{1}=2/10,\quad c_{2}=5/10, \quad c_{3}=3/10\]</div>
<p>The candidate stencils now have the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}
\cfrac{2}{3}f_{i-1/2}+\cfrac{1}{3}f_{i+1/2}=\cfrac{1}{6}(f_{i-1}+5f_{i})\\
\cfrac{1}{3}f_{i-1/2}+\cfrac{2}{3}f_{i+1/2}=\cfrac{1}{6}(5f_{i}+f_{i+1})\\
\cfrac{2}{3}f_{i+1/2}+\cfrac{1}{3}f_{i+3/2}=\cfrac{1}{6}(5f_{i}+f_{i+1})\\
\end{array}\end{split}\]</div>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/crweno1.png"><img alt="../../_images/crweno1.png" src="../../_images/crweno1.png" style="width: 800px;" />
</a>
<figcaption>
<p><span class="caption-text">CRWENO5 interface reconstruction. The three candidate stencils and the
corresponding reconstructed interfaces are plotted for the case u &gt; 0 and u &lt; 0. Each
number corresponds to a different stencil.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The underlying scheme is the compact fifth-order interpolation that can be obtained
by weighting the stencils with the optimal weights can be expressed as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\cfrac{3}{10}f_{i-1/2}+\cfrac{6}{10}f_{i+1/2}+\cfrac{1}{10}f_{i+3/2}
=\cfrac{1}{30}f_{i-1}+\cfrac{19}{30}f_{i}+\cfrac{1}{3}f_{i+1}\\\end{split}\]</div>
<p>As before, if the implicit candidate stencils are combined with a generic set of
weights <span class="math notranslate nohighlight">\(\omega_{k}\)</span>, the CRWENO interpolation is obtained:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
(\cfrac{2}{3}\omega_{1}+\cfrac{1}{3}\omega_{2}){f}_{i-1/2}
+\left[\cfrac{1}{3}\omega_{1}+\cfrac{2}{3}(\omega_{2}+\omega_{3})\right]{f}_{i+1/2}
+\cfrac{1}{3}\omega_{3}{f}_{i+3/2}\\
=\cfrac{\omega_{1}}{6}{f}_{i-1}
+\cfrac{5(\omega_{1}+\omega_{2})+\omega_{3}}{6}{f}_{i}
+\cfrac{\omega_{2}+5\omega_{3}}{6}{f}_{i+1}
\end{array}\end{split}\]</div>
</section>
<section id="compact-reconstruction-weno-5-scheme">
<h2>Compact Reconstruction WENO-5 Scheme<a class="headerlink" href="#compact-reconstruction-weno-5-scheme" title="Link to this heading"></a></h2>
<p>The WENO schemes are based on the idea of
combining lower order candidate stencils at an interface to get a higher order interpolation in smooth regions and a nonoscillatory interpolation near discontinuities. The
general form of the interface flux reconstructed by the WENO scheme is</p>
<div class="math notranslate nohighlight">
\[\hat{f}_{j+1/2}=\sum_{k=1}^{r} \omega_{k}\hat{f}^{k}_{j+1/2}\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the number of candidate stencils (of <span class="math notranslate nohighlight">\(r\text{th}\)</span> order),  <span class="math notranslate nohighlight">\(\hat{f}^{k}_{j+1/2}\)</span> is the interpolated
flux at <span class="math notranslate nohighlight">\(x_{j+1/2}\)</span> using the <span class="math notranslate nohighlight">\(k\text{th}\)</span> candidate stencil, and <span class="math notranslate nohighlight">\(\omega_{k}\)</span> is the weight of <span class="math notranslate nohighlight">\(k\text{th}\)</span> stencil
in the convex combination. There exist optimal weights <span class="math notranslate nohighlight">\(c_{k}, k = 1, . . . , r\)</span>, such that if <span class="math notranslate nohighlight">\(\omega_{k}=c_{k}\quad \forall k\)</span>,
the resulting interpolation is <span class="math notranslate nohighlight">\((2r − 1)\text{th}\)</span> order accurate.
The WENO limiting process causes the stencil weights to attain their optimal values where the
solution is smooth. Across or near a discontinuity, the weight of the stencil containing
the discontinuity approaches zero to yield a nonoscillatory interpolated flux. This is
achieved by scaling the optimal weights by smoothness indicators of the respective
stencils, i.e.,</p>
<div class="math notranslate nohighlight">
\[\alpha_{k}=\cfrac{c_{k}}{(\beta_{k}+\epsilon)^{m}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta_{k}\)</span> is the smoothness indicator of the <span class="math notranslate nohighlight">\(k\text{th}\)</span> stencil, is a small number to prevent division by zero, and <span class="math notranslate nohighlight">\(m\)</span> is chosen such that the weights for nonsmooth stencils
approach zero quickly (in the present study, <span class="math notranslate nohighlight">\(m=2\)</span> is used for all cases). To ensure
convexity, the weights <span class="math notranslate nohighlight">\(\alpha_{k}\)</span> are normalized as</p>
<div class="math notranslate nohighlight">
\[\omega_{k}=\cfrac{\alpha_{k}}{ {\textstyle \sum_{k}\alpha_{k}}}\]</div>
<p>The resulting interpolation is thus <span class="math notranslate nohighlight">\((2r − 1)\text{th}\)</span> order accurate in smooth regions of the
solution and nonoscillatory near discontinuities.</p>
<p>The main drawback of the WENO-5 scheme is that we have to increase the stencil size to get more accuracy. Compact reconstruction of WENO-5 scheme has been developed that uses smaller stencil without reducing the accuracy of the solution.
CRWENO-5 scheme uses compact stencils as their basis to calculate the left and right side state at the interface. The procedure for CRWENO-5 is similar to the WENO-5 scheme. However, its candidate stencils are implicit and hence smaller stencils can be used to get the same accuracy.
The implicit system used to compute the left and right side state is given below</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
(\cfrac{2}{3}\omega_{1}+\cfrac{1}{3}\omega_{2})\hat{f}_{j-1/2}
+\left[\cfrac{1}{3}\omega_{1}+\cfrac{2}{3}(\omega_{2}+\omega_{3})\right]\hat{f}_{j+1/2}
+\cfrac{1}{3}\omega_{3}\hat{f}_{j+3/2}\\
=\cfrac{\omega_{1}}{6}{f}_{j-1}
+\cfrac{5(\omega_{1}+\omega_{2})+\omega_{3}}{6}{f}_{j}
+\cfrac{\omega_{2}+5\omega_{3}}{6}{f}_{j+1}
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
(\cfrac{2}{3}\omega^{L}_{1}+\cfrac{1}{3}\omega^{L}_{2}){u}^{L}_{i-1/2}
+\left[\cfrac{1}{3}\omega^{L}_{1}+\cfrac{2}{3}(\omega^{L}_{2}+\omega^{L}_{3})\right]{u}^{L}_{i+1/2}
+\cfrac{1}{3}\omega^{L}_{3}{u}^{L}_{i+3/2}\\
=\cfrac{\omega^{L}_{1}}{6}{u}_{i-1}
+\cfrac{5(\omega^{L}_{1}+\omega^{L}_{2})+\omega^{L}_{3}}{6}{u}_{i}
+\cfrac{\omega^{L}_{2}+5\omega^{L}_{3}}{6}{u}_{i+1}
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\cfrac{1}{3}\omega^{R}_{1}{u}^{R}_{i-1/2}
+\left[\cfrac{1}{3}\omega^{R}_{3}+\cfrac{2}{3}(\omega^{R}_{2}+\omega^{R}_{1})\right]{u}^{R}_{i+1/2}
+(\cfrac{2}{3}\omega^{R}_{3}+\cfrac{1}{3}\omega^{R}_{2}){u}^{R}_{i+3/2}\\
=\cfrac{\omega^{R}_{2}+5\omega^{R}_{1}}{6}{u}_{i-1}
+\cfrac{5(\omega^{R}_{3}+\omega^{R}_{2})+\omega^{R}_{1}}{6}{u}_{i}
+\cfrac{\omega^{R}_{3}}{6}{u}_{i+1}
\end{array}\end{split}\]</div>
<p>The linear weights are given by
<span class="math notranslate nohighlight">\(d^{L}_{0}=1/5\)</span>, <span class="math notranslate nohighlight">\(d^{L}_{1}=1/2\)</span>, and <span class="math notranslate nohighlight">\(d^{L}_{2}=3/10\)</span> and
<span class="math notranslate nohighlight">\(d^{R}_{0}=3/10\)</span>, <span class="math notranslate nohighlight">\(d^{R}_{1}=1/2\)</span>, and <span class="math notranslate nohighlight">\(d^{R}_{2}=1/5\)</span>.</p>
<p>where the nonlinear weights are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}
w^{L}_{k}=\cfrac{\alpha_{k}}{\alpha_{0}+\alpha_{1}+\alpha_{2}},\quad \alpha_{k}=\cfrac{d^{L}_{k}}{(\beta_{k}+\epsilon)^{2}},\quad k=0,1,2\\
w^{R}_{k}=\cfrac{\alpha_{k}}{\alpha_{0}+\alpha_{1}+\alpha_{2}},\quad \alpha_{k}=\cfrac{d^{R}_{k}}{(\beta_{k}+\epsilon)^{2}},\quad k=0,1,2
\end{array}\end{split}\]</div>
<p>in which the smoothness indicators are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\beta_{0}=\cfrac{13}{12}(u_{i-2}-2u_{i-1}+u_{i})^2+\cfrac{1}{4}(u_{i-2}-4u_{i-1}+3u_{i})^2\\
\beta_{1}=\cfrac{13}{12}(u_{i-1}-2u_{i}+u_{i+1})^2+\cfrac{1}{4}(u_{i-1}-u_{i+1})^2\\
\beta_{2}=\cfrac{13}{12}(u_{i}-2u_{i+1}+u_{i+2})^2+\cfrac{1}{4}(3u_{i}-4u_{i+1}+u_{i+2})^2
\end{array}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}d^{L}=\begin{bmatrix}
 d^{L}_{0}\\d^{L}_{1}\\d^{L}_{2}
\end{bmatrix}
=\begin{bmatrix}
 1/5\\1/2\\3/10
\end{bmatrix}
=\begin{bmatrix}
 0.2\\0.5\\0.3
\end{bmatrix}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}d^{R}=\begin{bmatrix}
 d^{R}_{0}\\d^{R}_{1}\\d^{R}_{2}
\end{bmatrix}
=\begin{bmatrix}
 3/10\\1/2\\1/5
\end{bmatrix}
=\begin{bmatrix}
 0.3\\0.5\\0.2
\end{bmatrix}\end{split}\]</div>
<p>Implicit equations</p>
<div class="math notranslate nohighlight">
\[a{f}_{i-1/2}+b{f}_{i+1/2} +c{f}_{i+3/2}=d_{i}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{0}{f}_{0-1/2}+b_{0}{f}_{0+1/2}+c_{0}{f}_{0+3/2}=d_{0}\\
a_{1}{f}_{1-1/2}+b_{1}{f}_{1+1/2}+c_{1}{f}_{1+3/2}=d_{1}\\
a_{2}{f}_{2-1/2}+b_{2}{f}_{2+1/2}+c_{2}{f}_{2+3/2}=d_{2}\\
\vdots\\
a_{i}{f}_{i-1/2}+b_{i}{f}_{i+1/2}+c_{i}{f}_{i+3/2}=d_{i}\\
\vdots\\
a_{N-2}{f}_{N-2-1/2}+b_{N-2}{f}_{N-2+1/2}+c_{N-2}{f}_{N-2+3/2}=d_{N-2}\\
a_{N-1}{f}_{N-1-1/2}+b_{N-1}{f}_{N-1+1/2}+c_{N-1}{f}_{N-1+3/2}=d_{N-1}\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{0}{f}_{-1/2}+b_{0}{f}_{1/2}+c_{0}{f}_{3/2}=d_{0}\\
a_{1}{f}_{1/2}+b_{1}{f}_{3/2}+c_{1}{f}_{5/2}=d_{1}\\
a_{2}{f}_{3/2}+b_{2}{f}_{5/2}+c_{2}{f}_{7/2}=d_{2}\\
\vdots\\
a_{i}{f}_{i-1/2}+b_{i}{f}_{i+1/2}+c_{i}{f}_{i+3/2}=d_{i}\\
\vdots\\
a_{N-2}{f}_{N-5/2}+b_{N-2}{f}_{N-3/2}+c_{N-2}{f}_{N-1/2}=d_{N-2}\\
a_{N-1}{f}_{N-3/2}+b_{N-1}{f}_{N-1/2}+c_{N-1}{f}_{N+1/2}=d_{N-1}\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
b_{0}{f}_{1/2}+c_{0}{f}_{3/2}=d_{0}-a_{0}{f}_{-1/2}\\
a_{1}{f}_{1/2}+b_{1}{f}_{3/2}+c_{1}{f}_{5/2}=d_{1}\\
a_{2}{f}_{3/2}+b_{2}{f}_{5/2}+c_{2}{f}_{7/2}=d_{2}\\
\vdots\\
a_{i}{f}_{i-1/2}+b_{i}{f}_{i+1/2}+c_{i}{f}_{i+3/2}=d_{i}\\
\vdots\\
a_{N-2}{f}_{N-5/2}+b_{N-2}{f}_{N-3/2}+c_{N-2}{f}_{N-1/2}=d_{N-2}\\
a_{N-1}{f}_{N-3/2}+b_{N-1}{f}_{N-1/2}=d_{N-1}-c_{N-1}{f}_{N+1/2}\\
\end{array}\end{split}\]</div>
<p>Matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
b_{0}&amp;c_{0}&amp; \\
a_{1}&amp;b_{1}&amp;c_{1}&amp;  &amp; \\
&amp;  \ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;a_{i}&amp;b_{i}&amp;c_{i} \\
&amp;&amp;&amp;\ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;&amp;&amp;a_{N-2}&amp;b_{N-2}&amp;c_{N-2} \\
&amp;&amp;&amp;&amp;&amp;a_{N-1}&amp;b_{N-1}
\end{bmatrix}
\begin{bmatrix}
{f}_{1/2}\\
{f}_{3/2}\\
\vdots\\
{f}_{i+1/2}\\
\vdots\\
{f}_{N-3/2}\\
{f}_{N-1/2}\\
\end{bmatrix}
=\begin{bmatrix}
{d}_{0}-{a}_{0}{f}_{-1/2}\\
{d}_{1}\\
\vdots\\
{d}_{i}\\
\vdots\\
{d}_{N-2}\\
{d}_{N-1}-{c}_{N-1}{f}_{N+1/2}\\
\end{bmatrix}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{i}=\cfrac{2}{3}\omega^{L}_{1}+\cfrac{1}{3}\omega^{L}_{2}\\
b_{i}=\cfrac{1}{3}\omega^{L}_{1}+\cfrac{2}{3}(\omega^{L}_{2}+\omega^{L}_{3})\\
c_{i}=\cfrac{1}{3}\omega^{L}_{3}\\
d_{i}=\cfrac{\omega^{L}_{1}}{6}{u}_{i-1}
+\cfrac{5(\omega^{L}_{1}+\omega^{L}_{2})+\omega^{L}_{3}}{6}{u}_{i}
+\cfrac{\omega^{L}_{2}+5\omega^{L}_{3}}{6}{u}_{i+1}
\end{array}\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[a_{0}=\cfrac{2}{3}\omega^{L}_{1}+\cfrac{1}{3}\omega^{L}_{2}=0\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\omega^{L}_{1}=0\\
\omega^{L}_{2}=0\\
\omega^{L}_{3}=1\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
b_{0} &amp; = (\cfrac{1}{3}\omega^{L}_{1} = 0)+\cfrac{2}{3}((\omega^{L}_{2} = 0)+(\omega^{L}_{3} = 1)) = \cfrac{2}{3}\\
c_{0} &amp; = \cfrac{1}{3}(\omega^{L}_{3} = 1) = \cfrac{1}{3}\\
d_{0} &amp; = \cfrac{\omega^{L}_{1} = 0}{6}{u}_{-1}
+\cfrac{5((\omega^{L}_{1} = 0)+(\omega^{L}_{2} = 0))+(\omega^{L}_{3} = 1)}{6}{u}_{0}
+\cfrac{(\omega^{L}_{2} = 0)+5(\omega^{L}_{3}  = 1)}{6}{u}_{1}\\ &amp; = \cfrac{1}{6}{u}_{0}+\cfrac{5}{6}{u}_{1}
\end{align}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
a_{0} &amp; = 0\\
b_{0} &amp; = \cfrac{2}{3}\\
c_{0} &amp; =\cfrac{1}{3}\\
d_{0} &amp; = \cfrac{1}{6}{u}_{0}+\cfrac{5}{6}{u}_{1}
\end{align}\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}
c_{N-1}=\cfrac{1}{3}\omega^{L}_{3}=0\\
\cfrac{\omega^{L}_{2}+5\omega^{L}_{3}}{6}=0
\end{array}\end{split}\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\omega^{L}_{1}=1\\
\omega^{L}_{2}=0\\
\omega^{L}_{3}=0\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
a_{N-1} &amp; = \cfrac{2}{3}(\omega^{L}_{1}=1)+\cfrac{1}{3}(\omega^{L}_{2}=0)\\
b_{N-1} &amp; = \cfrac{1}{3}(\omega^{L}_{1}=1)+\cfrac{2}{3}((\omega^{L}_{2}=0)+(\omega^{L}_{3}=0))\\
c_{N-1} &amp; = \cfrac{1}{3}(\omega^{L}_{3}=0)\\
d_{N-1} &amp; = \cfrac{(\omega^{L}_{1}=1)}{6}{u}_{N-1}\\
&amp;+\cfrac{5((\omega^{L}_{1}=1)+(\omega^{L}_{2}=0))+(\omega^{L}_{3}=0)}{6}{u}_{N}\\
&amp;+\cfrac{(\omega^{L}_{2}=0)+5(\omega^{L}_{3}=0)}{6}{u}_{N+1}
\end{align}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
a_{N-1} &amp; = \cfrac{2}{3}\\
b_{N-1} &amp; = \cfrac{1}{3}\\
c_{N-1} &amp; = 0\\
d_{N-1} &amp; = \cfrac{1}{6}{u}_{N-1}+\cfrac{5}{6}{u}_{N}\\
\end{align}\end{split}\]</div>
<p>for</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\cfrac{1}{3}\omega^{R}_{1}{u}^{R}_{i-1/2}
+\left[\cfrac{1}{3}\omega^{R}_{3}+\cfrac{2}{3}(\omega^{R}_{2}+\omega^{R}_{1})\right]{u}^{R}_{i+1/2}
+(\cfrac{2}{3}\omega^{R}_{3}+\cfrac{1}{3}\omega^{R}_{2}){u}^{R}_{i+3/2}\\
=\cfrac{\omega^{R}_{2}+5\omega^{R}_{1}}{6}{u}_{i-1}
+\cfrac{5(\omega^{R}_{3}+\omega^{R}_{2})+\omega^{R}_{1}}{6}{u}_{i}
+\cfrac{\omega^{R}_{3}}{6}{u}_{i+1}
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{i}=\cfrac{1}{3}\omega^{R}_{1}\\
b_{i}=\cfrac{1}{3}\omega^{R}_{3}+\cfrac{2}{3}(\omega^{R}_{2}+\omega^{R}_{1})\\
c_{i}=\cfrac{2}{3}\omega^{R}_{3}+\cfrac{1}{3}\omega^{R}_{2}\\
d_{i}=\cfrac{\omega^{R}_{2}+5\omega^{R}_{1}}{6}{u}_{i-1}
+\cfrac{5(\omega^{R}_{3}+\omega^{R}_{2})+\omega^{R}_{1}}{6}{u}_{i}
+\cfrac{\omega^{R}_{3}}{6}{u}_{i+1}
\end{array}\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[a_{0}=\cfrac{1}{3}\omega^{R}_{1}=0\Rightarrow \omega^{R}_{1}=0\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\omega^{R}_{1}=0,\cfrac{\omega^{R}_{2}+5\omega^{R}_{1}}{6}=0\Rightarrow \omega^{R}_{2}=0\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\omega^{R}_{1}=0\\
\omega^{R}_{2}=0\\
\omega^{R}_{3}=1
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
b_{0}=\cfrac{1}{3}(\omega^{R}_{3}=1)+\cfrac{2}{3}((\omega^{R}_{2}=0)+(\omega^{R}_{1}=0))\\
c_{0}=\cfrac{2}{3}(\omega^{R}_{3}=1)+\cfrac{1}{3}(\omega^{R}_{2}=0)\\
d_{0}=\cfrac{(\omega^{R}_{2}=0)+5(\omega^{R}_{1}=0)}{6}{u}_{-1}\\
+\cfrac{5((\omega^{R}_{3}=1)+(\omega^{R}_{2}=0))+(\omega^{R}_{1}=0)}{6}{u}_{0}\\
+\cfrac{(\omega^{R}_{3}=1)}{6}{u}_{1}
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{0}=0\\
b_{0}=\cfrac{1}{3}\\
c_{0}=\cfrac{2}{3}\\
d_{0}=\cfrac{5}{6}{u}_{0}
+\cfrac{1}{6}{u}_{1}
\end{array}\end{split}\]</div>
<p>for</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{N-1}=\cfrac{1}{3}\omega^{R}_{1}\\
b_{N-1}=\cfrac{1}{3}\omega^{R}_{3}+\cfrac{2}{3}(\omega^{R}_{2}+\omega^{R}_{1})\\
c_{N-1}=\cfrac{2}{3}\omega^{R}_{3}+\cfrac{1}{3}\omega^{R}_{2}\\
d_{N-1}=\cfrac{\omega^{R}_{2}+5\omega^{R}_{1}}{6}{u}_{N-2}
+\cfrac{5(\omega^{R}_{3}+\omega^{R}_{2})+\omega^{R}_{1}}{6}{u}_{N-1}
+\cfrac{\omega^{R}_{3}}{6}{u}_{N}
\end{array}\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[c_{N-1}=\cfrac{2}{3}\omega^{R}_{3}+\cfrac{1}{3}\omega^{R}_{2}=0\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\omega^{R}_{1}=1\\
\omega^{R}_{2}=0\\
\omega^{R}_{3}=0
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{N-1}=\cfrac{1}{3}(\omega^{R}_{1}=1)\\
b_{N-1}=\cfrac{1}{3}(\omega^{R}_{3}=0)+\cfrac{2}{3}((\omega^{R}_{2}=0)+(\omega^{R}_{1}=1))\\
c_{N-1}=\cfrac{2}{3}(\omega^{R}_{3}=0)+\cfrac{1}{3}(\omega^{R}_{2}=0)\\
d_{N-1}=\cfrac{(\omega^{R}_{2}=0)+5(\omega^{R}_{1}=1)}{6}{u}_{N-2}\\
+\cfrac{5((\omega^{R}_{3}=0)+(\omega^{R}_{2}=0))+(\omega^{R}_{1}=1)}{6}{u}_{N-1}\\
+\cfrac{(\omega^{R}_{3}=0)}{6}{u}_{N}
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
a_{N-1}=\cfrac{1}{3}\\
b_{N-1}=\cfrac{2}{3}\\
c_{N-1}=0\\
d_{N-1}=\cfrac{5}{6}{u}_{N-2}+\cfrac{1}{6}{u}_{N-1}\\
\end{array}\end{split}\]</div>
</section>
<section id="crweno-5-with-periodic-boundary-condition">
<h2>CRWENO-5 with periodic boundary condition<a class="headerlink" href="#crweno-5-with-periodic-boundary-condition" title="Link to this heading"></a></h2>
<div class="math notranslate nohighlight">
\[\underbrace{\overset{\otimes}{-2}, \overset{\otimes}{-1}}_{\text{ghost points}}
\underbrace{\overset{|}{-1/2}}_{\text{face}}
\underbrace{\overset{\otimes}{0}}_{\text{bc}}
\underbrace{\overset{|}{1/2}}_{\text{face}}
\underbrace{,\overset{\otimes}{1},\overset{\otimes}{2},\cdots,\overset{\otimes}{N-2},\overset{\otimes}{N-1},}_{\text{inner points}}
\underbrace{\overset{|}{N-1/2}}_{\text{face}}
\underbrace{\overset{\otimes}{N}}_{\text{bc}}
\underbrace{\overset{|}{N+1/2}}_{\text{face}}
\underbrace{,\overset{\otimes}{N+1},\overset{\otimes}{N+2}}_{\text{ghost points}}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
u^{L}_{-1/2}=u^{L}_{N-1/2}\Leftrightarrow \hat{u}^{L}_{-1}=\hat{u}^{L}_{N-1}\\
u^{R}_{-1/2}=u^{R}_{N-1/2}\Leftrightarrow \hat{u}^{R}_{-1}=\hat{u}^{R}_{N-1}\\
u^{L}_{N+1/2}=u^{L}_{1/2}\Leftrightarrow \hat{u}^{L}_{N}=\hat{u}^{L}_{1}\\
u^{R}_{N+1/2}=u^{R}_{1/2}\Leftrightarrow \hat{u}^{R}_{N}=\hat{u}^{R}_{1}\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
b_{0}{f}_{1/2}+c_{0}{f}_{3/2}=d_{0}-a_{0}{f}_{-1/2}\\
a_{1}{f}_{1/2}+b_{1}{f}_{3/2}+c_{1}{f}_{5/2}=d_{1}\\
a_{2}{f}_{3/2}+b_{2}{f}_{5/2}+c_{2}{f}_{7/2}=d_{2}\\
\vdots\\
a_{i}{f}_{i-1/2}+b_{i}{f}_{i+1/2}+c_{i}{f}_{i+3/2}=d_{i}\\
\vdots\\
a_{N-2}{f}_{N-5/2}+b_{N-2}{f}_{N-3/2}+c_{N-2}{f}_{N-1/2}=d_{N-2}\\
a_{N-1}{f}_{N-3/2}+b_{N-1}{f}_{N-1/2}=d_{N-1}-c_{N-1}{f}_{N+1/2}\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
b_{0}{f}_{1/2}+c_{0}{f}_{3/2}=d_{0}-a_{0}{f}_{N-1/2}\\
a_{1}{f}_{1/2}+b_{1}{f}_{3/2}+c_{1}{f}_{5/2}=d_{1}\\
a_{2}{f}_{3/2}+b_{2}{f}_{5/2}+c_{2}{f}_{7/2}=d_{2}\\
\vdots\\
a_{i}{f}_{i-1/2}+b_{i}{f}_{i+1/2}+c_{i}{f}_{i+3/2}=d_{i}\\
\vdots\\
a_{N-2}{f}_{N-5/2}+b_{N-2}{f}_{N-3/2}+c_{N-2}{f}_{N-1/2}=d_{N-2}\\
a_{N-1}{f}_{N-3/2}+b_{N-1}{f}_{N-1/2}=d_{N-1}-c_{N-1}{f}_{1/2}\\
\end{array}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
b_{0}{f}_{1/2}+c_{0}{f}_{3/2}+a_{0}{f}_{N-1/2}=d_{0}\\
a_{1}{f}_{1/2}+b_{1}{f}_{3/2}+c_{1}{f}_{5/2}=d_{1}\\
a_{2}{f}_{3/2}+b_{2}{f}_{5/2}+c_{2}{f}_{7/2}=d_{2}\\
\vdots\\
a_{i}{f}_{i-1/2}+b_{i}{f}_{i+1/2}+c_{i}{f}_{i+3/2}=d_{i}\\
\vdots\\
a_{N-2}{f}_{N-5/2}+b_{N-2}{f}_{N-3/2}+c_{N-2}{f}_{N-1/2}=d_{N-2}\\
a_{N-1}{f}_{N-3/2}+b_{N-1}{f}_{N-1/2}+c_{N-1}{f}_{1/2}=d_{N-1}\\
\end{array}\end{split}\]</div>
<p>Matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
b_{0}&amp;c_{0}&amp;&amp;&amp;&amp;&amp;{a}_{0}\\
a_{1}&amp;b_{1}&amp;c_{1}&amp;  &amp; \\
&amp;  \ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;a_{i}&amp;b_{i}&amp;c_{i} \\
&amp;&amp;&amp;\ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;&amp;&amp;a_{N-2}&amp;b_{N-2}&amp;c_{N-2} \\
c_{N-1}&amp;&amp;&amp;&amp;&amp;a_{N-1}&amp;b_{N-1}
\end{bmatrix}
\begin{bmatrix}
{f}_{1/2}\\
{f}_{3/2}\\
\vdots\\
{f}_{i+1/2}\\
\vdots\\
{f}_{N-3/2}\\
{f}_{N-1/2}\\
\end{bmatrix}
=\begin{bmatrix}
{d}_{0}\\
{d}_{1}\\
\vdots\\
{d}_{i}\\
\vdots\\
{d}_{N-2}\\
{d}_{N-1}\\
\end{bmatrix}\end{split}\]</div>
</section>
<section id="sherman-morrison-formula">
<h2>Sherman-Morrison Formula<a class="headerlink" href="#sherman-morrison-formula" title="Link to this heading"></a></h2>
<p>For some other sparse problems, the Sherman-Morrison formula cannot be
directly applied for the simple reason that storage of the whole inverse matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span>
is not feasible. If you want to add only a single correction of the form <span class="math notranslate nohighlight">\(\mathbf{p}\otimes\mathbf{q}\)</span>,
and solve the linear system</p>
<div class="math notranslate nohighlight">
\[(\mathbf{A}+\mathbf{p}\otimes\mathbf{q})\cdot\mathbf{x}=\mathbf{d}\]</div>
<p>then you proceed as follows. Using the fast method that is presumed available for
the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, solve the two auxiliary problems</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\cdot\mathbf{y}=\mathbf{d}\quad \mathbf{A}\cdot\mathbf{z}=\mathbf{p}\]</div>
<p>for the vectors <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}\)</span>. In terms of these,</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}=\mathbf{y}-\left[\cfrac{\mathbf{q}\cdot\mathbf{y}}{1+(\mathbf{q}\cdot\mathbf{z})}\right]\mathbf{z}\]</div>
<p>We use the Sherman-Morrison formula, treating the system as tridiagonal plus
a correction. In the notation of equation, define vectors <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{p}=\left[\begin{array}{c}
\gamma\\0\\ \vdots\\0\\ \alpha
\end{array}\right] \quad
\mathbf{q}=\left[\begin{array}{c}
1\\0\\ \vdots\\0\\ \beta/\gamma
\end{array}\right]\\\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{\hat{A}}=\begin{bmatrix}
b_{0}&amp;c_{0}&amp;&amp;&amp;&amp;&amp;{a}_{0}\\
a_{1}&amp;b_{1}&amp;c_{1}&amp;  &amp; \\
&amp;  \ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;a_{i}&amp;b_{i}&amp;c_{i} \\
&amp;&amp;&amp;\ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;&amp;&amp;a_{N-2}&amp;b_{N-2}&amp;c_{N-2} \\
c_{N-1}&amp;&amp;&amp;&amp;&amp;a_{N-1}&amp;b_{N-1}
\end{bmatrix}\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\beta=a_{0}\\
\alpha=c_{N-1}\\
\gamma=-b_{0}
\end{array}\end{split}\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\begin{split}b'_{0}=b_{0}-\gamma, \quad b'_{N-1}=b_{N-1}-\alpha\beta/\gamma\\\end{split}\]</div>
<ul class="simple">
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{{A}}=\begin{bmatrix}
b'_{0}&amp;c_{0}&amp;&amp;&amp;&amp;&amp;&amp;\\
a_{1}&amp;b_{1}&amp;c_{1}&amp;  &amp; \\
&amp;  \ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;a_{i}&amp;b_{i}&amp;c_{i} \\
&amp;&amp;&amp;\ddots&amp;\ddots &amp;\ddots \\
&amp;&amp;&amp;&amp;a_{N-2}&amp;b_{N-2}&amp;c_{N-2} \\
&amp;&amp;&amp;&amp;&amp;&amp;a_{N-1}&amp;b'_{N-1}
\end{bmatrix}\end{split}\]</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="icp.html" class="btn btn-neutral float-left" title="Implicit Compact Pade (ICP) Scheme" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hllc.html" class="btn btn-neutral float-right" title="HLLC Riemann Solver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017~2024, eric.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>